# Session 3 – Transcriptome Analysis (Watered Samples)

**Authors:** Abdennacer Kara and Iness Hidouri  

---

## 1. Introduction

This report corresponds to Session 3: Analysis of Transcriptomes and documents the construction and interpretation of a gene co-expression network using RNA-seq data from watered (W) samples. The analysis was performed following the workflow provided in Practical_WGCNA_W_dataset.Rmd, and all scripts and results are available in the transcripts/ directory of the GitHub repository used throughout the course.

The primary objective of this session was to identify groups of transcripts showing coordinated expression patterns and to explore their relationships with phenotypic traits using Weighted Gene Co-expression Network Analysis (WGCNA).

---

## 2. Data preparation and quality control

The transcript-level expression dataset TPM_counts_Drought_W_dataset.csv was used as input for the analysis. Isoform identifiers were retained exclusively for labeling and annotation purposes, while expression values (TPM) were used to generate a samples-by-isoforms expression matrix suitable for network construction.

Quality control was conducted using the goodSamplesGenes function from the WGCNA package to identify potential outlier samples or transcripts. This step confirmed that all samples showed acceptable expression profiles, with no excessive missing values or abnormal patterns. Consequently, no samples were removed, and the complete dataset was retained for downstream analyses.

---

## 3. Network construction and module detection

Pairwise Pearson correlations were calculated between all transcript expression profiles. These correlations were transformed into an adjacency matrix using a soft-thresholding power selected based on the scale-free topology criterion. The adjacency matrix was subsequently converted into a Topological Overlap Matrix (TOM), which accounts for shared network connectivity and provides a robust distance metric for hierarchical clustering.

To determine the appropriate soft-thresholding power, the scale-free topology fit index (R²) and mean connectivity were evaluated across a range of candidate values.

Co-expression modules were initially identified using dynamic tree cutting applied to the hierarchical clustering dendrogram. To reduce redundancy, module eigengenes were calculated to summarize the expression profile of each module, and modules with highly correlated eigengenes were merged.

---

## 4. Module–trait relationships and hub isoforms

Module eigengenes were correlated with phenotypic traits to assess biologically meaningful associations. These relationships were visualized using a module–trait correlation heat map, where each cell represents the Pearson correlation coefficient between a module eigengene and a given trait.

Hub isoforms were identified for each module based on intramodular connectivity using the chooseTopHubInEachModule() function. Hub isoforms represent transcripts that are highly connected within their respective modules and may play key regulatory roles.

---

## 5. Answers to specific questions

### 5.1 How many samples and isoforms are included in TPM_counts_Drought_W_dataset.csv?

The dataset contains expression data for 9,940 isoforms across 39 RNA-seq samples corresponding to the watered (W) condition. Each row represents a transcript isoform, while each column corresponds to a biological sample.

### 5.2 How many samples are discarded after outlier analysis?

No samples were discarded after outlier analysis. All 39 samples passed the quality control criteria and were included in the co-expression network analysis.

### 5.3 What power value was selected for calculating adjacency?

A soft-thresholding power of β = 6 was selected. At this value, the scale-free topology fit index (R²) reached 0.879, exceeding the commonly accepted threshold of 0.8. This choice ensured an appropriate balance between scale-free topology approximation and network connectivity.

### 5.4 How many co-expression modules were identified before and after module merging?

Dynamic tree cutting initially identified 40 co-expression modules (excluding the grey module of unassigned transcripts). After merging modules with highly correlated eigengenes using a cut height of 0.25, the final number of modules was reduced to 36.

### 5.5 What is the hub isoform of the cyan module?

The hub isoform of each module was identified based on intramodular connectivity. The hub isoform of the cyan module was:

Bradi1g00700.3

### 5.6 Which module shows the highest positive correlation with the blwgrd (below-ground biomass) trait?

The violet module (MEviolet) showed the strongest positive association with the blwgrd trait, with a Pearson correlation coefficient of r = 0.64, indicating a strong relationship between this module and below-ground biomass under watered conditions.

---

## 6. Conclusions

This analysis successfully identified transcript co-expression modules in watered RNA-seq samples and revealed meaningful associations between specific modules and phenotypic traits. The results highlight candidate modules and hub isoforms potentially involved in biomass-related processes and provide a foundation for further functional and comparative transcriptomic analyses.

